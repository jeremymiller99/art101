<!DOCTYPE html>
<html>
<head>
    <title>JJ's 3D Interactive Homepage</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="css/site.css">
    <link rel="stylesheet" type="text/css" href="css/homepage.css">
    
    <!-- Three.js and related libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cannon.js/0.6.2/cannon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
</head>
<body>
    <main id="content">
        <section>
            <h1>JJ's 3D Interactive Homepage</h1>
            <div class="minor-section">
                <img class="cat-photo" src="./img/cute-grey-kitten.jpg">
                <h2>About Me</h2>
                <p>My name is JJ. Welcome to my interactive 3D website!</p>
            </div>
        </section>
        
        <!-- 3D scene container -->
        <div id="scene-container" style="width: 100%; height: 500px;"></div>
        
        <nav id="links">
            <!-- Put links to labs here. -->
        </nav>
    </main>

    <script>
        let scene, camera, renderer, controls;
        let world, physicsMaterial, cubeBody, cubeMesh;

        function init() {
            // Set up Three.js scene
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.getElementById('scene-container').appendChild(renderer.domElement);

            // Set up camera and controls
            camera.position.set(0, 5, 10);
            controls = new THREE.OrbitControls(camera, renderer.domElement);

            // Set up lights
            const ambientLight = new THREE.AmbientLight(0x404040);
            scene.add(ambientLight);
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
            directionalLight.position.set(1, 1, 1);
            scene.add(directionalLight);

            // Set up Cannon.js world
            world = new CANNON.World();
            world.gravity.set(0, -9.82, 0);
            physicsMaterial = new CANNON.Material("slipperyMaterial");

            // Create a ground plane
            const groundShape = new CANNON.Plane();
            const groundBody = new CANNON.Body({ mass: 0, material: physicsMaterial });
            groundBody.addShape(groundShape);
            groundBody.quaternion.setFromAxisAngle(new CANNON.Vec3(1, 0, 0), -Math.PI / 2);
            world.addBody(groundBody);

            // Create a visual ground plane
            const groundGeometry = new THREE.PlaneGeometry(20, 20);
            const groundMaterial = new THREE.MeshBasicMaterial({ color: 0xcccccc, side: THREE.DoubleSide });
            const groundMesh = new THREE.Mesh(groundGeometry, groundMaterial);
            groundMesh.rotation.x = -Math.PI / 2;
            scene.add(groundMesh);

            // Create a cube
            const cubeSize = 1;
            const cubeGeometry = new THREE.BoxGeometry(cubeSize, cubeSize, cubeSize);
            const cubeMaterial = new THREE.MeshPhongMaterial({ color: 0x00ff00 });
            cubeMesh = new THREE.Mesh(cubeGeometry, cubeMaterial);
            scene.add(cubeMesh);

            // Create a physics body for the cube
            const cubeShape = new CANNON.Box(new CANNON.Vec3(cubeSize/2, cubeSize/2, cubeSize/2));
            cubeBody = new CANNON.Body({
                mass: 1,
                shape: cubeShape,
                material: physicsMaterial
            });
            cubeBody.position.set(0, 5, 0);
            world.addBody(cubeBody);

            // Add click event listener to throw the cube
            renderer.domElement.addEventListener('click', throwCube);

            animate();
        }

        function throwCube(event) {
            if (cubeBody) {
                const force = 15;
                const clickX = (event.clientX / window.innerWidth) * 2 - 1;
                const clickY = -(event.clientY / window.innerHeight) * 2 + 1;

                const vector = new THREE.Vector3(clickX, clickY, 0.5);
                vector.unproject(camera);
                vector.sub(camera.position).normalize();

                cubeBody.velocity.set(
                    vector.x * force,
                    vector.y * force,
                    vector.z * force
                );
            }
        }

        function animate() {
            requestAnimationFrame(animate);

            world.step(1 / 60);

            if (cubeMesh && cubeBody) {
                cubeMesh.position.copy(cubeBody.position);
                cubeMesh.quaternion.copy(cubeBody.quaternion);
            }

            renderer.render(scene, camera);
        }

        init();
    </script>
</body>
</html>